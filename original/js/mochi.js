/***

    MochiKit.MochiKit 1.4 : PACKED VERSION

    THIS FILE IS AUTOMATICALLY GENERATED.  If creating patches, please
    diff against the source tree, not this file.

    See <http://mochikit.com/> for documentation, downloads, license, etc.

    (c) 2005 Bob Ippolito.  All rights Reserved.

***/

typeof dojo!="undefined"&&dojo.provide("MochiKit.Base"),typeof MochiKit=="undefined"&&(MochiKit={}),typeof MochiKit.Base=="undefined"&&(MochiKit.Base={}),typeof MochiKit.__export__=="undefined"&&(MochiKit.__export__=MochiKit.__compat__||typeof JSAN=="undefined"&&typeof dojo=="undefined"),MochiKit.Base.VERSION="1.4",MochiKit.Base.NAME="MochiKit.Base",MochiKit.Base.update=function(a,b){a===null&&(a={});for(var c=1;c<arguments.length;c++){var d=arguments[c];if(typeof d!="undefined"&&d!==null)for(var e in d)a[e]=d[e]}return a},MochiKit.Base.update(MochiKit.Base,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},camelize:function(a){var b=a.split("-"),c=b[0];for(var d=1;d<b.length;d++)c+=b[d].charAt(0).toUpperCase()+b[d].substring(1);return c},counter:function(a){return arguments.length===0&&(a=1),function(){return a++}},clone:function(a){var b=arguments.callee;if(arguments.length==1)return b.prototype=a,new b},_flattenArray:function(a,b){for(var c=0;c<b.length;c++){var d=b[c];d instanceof Array?arguments.callee(a,d):a.push(d)}return a},flattenArray:function(a){return MochiKit.Base._flattenArray([],a)},flattenArguments:function(a){var b=[],c=MochiKit.Base,d=c.extend(null,arguments);while(d.length){var e=d.shift();if(e&&typeof e=="object"&&typeof e.length=="number")for(var f=e.length-1;f>=0;f--)d.unshift(e[f]);else b.push(e)}return b},extend:function(a,b,c){c||(c=0);if(b){var d=b.length;if(typeof d!="number")if(typeof MochiKit.Iter!="undefined")b=MochiKit.Iter.list(b),d=b.length;else throw new TypeError("Argument not an array-like and MochiKit.Iter not present");a||(a=[]);for(var e=c;e<d;e++)a.push(b[e])}return a},updatetree:function(a,b){a===null&&(a={});for(var c=1;c<arguments.length;c++){var d=arguments[c];if(typeof d!="undefined"&&d!==null)for(var e in d){var f=d[e];typeof a[e]=="object"&&typeof f=="object"?arguments.callee(a[e],f):a[e]=f}}return a},setdefault:function(a,b){a===null&&(a={});for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var e in d)e in a||(a[e]=d[e])}return a},keys:function(a){var b=[];for(var c in a)b.push(c);return b},values:function(a){var b=[];for(var c in a)b.push(a[c]);return b},items:function(a){var b=[],c;for(var d in a){var e;try{e=a[d]}catch(c){continue}b.push([d,e])}return b},_newNamedError:function(a,b,c){c.prototype=new MochiKit.Base.NamedError(a.NAME+"."+b),a[b]=c},operator:{truth:function(a){return!!a},lognot:function(a){return!a},identity:function(a){return a},not:function(a){return~a},neg:function(a){return-a},add:function(a,b){return a+b},sub:function(a,b){return a-b},div:function(a,b){return a/b},mod:function(a,b){return a%b},mul:function(a,b){return a*b},and:function(a,b){return a&b},or:function(a,b){return a|b},xor:function(a,b){return a^b},lshift:function(a,b){return a<<b},rshift:function(a,b){return a>>b},zrshift:function(a,b){return a>>>b},eq:function(a,b){return a==b},ne:function(a,b){return a!=b},gt:function(a,b){return a>b},ge:function(a,b){return a>=b},lt:function(a,b){return a<b},le:function(a,b){return a<=b},seq:function(a,b){return a===b},sne:function(a,b){return a!==b},ceq:function(a,b){return MochiKit.Base.compare(a,b)===0},cne:function(a,b){return MochiKit.Base.compare(a,b)!==0},cgt:function(a,b){return MochiKit.Base.compare(a,b)==1},cge:function(a,b){return MochiKit.Base.compare(a,b)!=-1},clt:function(a,b){return MochiKit.Base.compare(a,b)==-1},cle:function(a,b){return MochiKit.Base.compare(a,b)!=1},logand:function(a,b){return a&&b},logor:function(a,b){return a||b},contains:function(a,b){return b in a}},forwardCall:function(a){return function(){return this[a].apply(this,arguments)}},itemgetter:function(a){return function(b){return b[a]}},typeMatcher:function(){var a={};for(var b=0;b<arguments.length;b++){var c=arguments[b];a[c]=c}return function(){for(var b=0;b<arguments.length;b++)if(!(typeof arguments[b]in a))return!1;return!0}},isNull:function(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==null)return!1;return!0},isUndefinedOrNull:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(typeof b!="undefined"&&b!==null)return!1}return!0},isEmpty:function(a){return!MochiKit.Base.isNotEmpty.apply(this,arguments)},isNotEmpty:function(a){for(var b=0;b<arguments.length;b++){var c=arguments[b];if(!c||!c.length)return!1}return!0},isArrayLike:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a],c=typeof b;if(c!="object"&&(c!="function"||typeof b.item!="function")||b===null||typeof b.length!="number"||b.nodeType===3)return!1}return!0},isDateLike:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(typeof b!="object"||b===null||typeof b.getTime!="function")return!1}return!0},xmap:function(a){if(a===null)return MochiKit.Base.extend(null,arguments,1);var b=[];for(var c=1;c<arguments.length;c++)b.push(a(arguments[c]));return b},map:function(a,b){var c=MochiKit.Base,d=MochiKit.Iter,e=c.isArrayLike;if(arguments.length<=2){if(!e(b)){if(!d)throw new TypeError("Argument not an array-like and MochiKit.Iter not present");b=d.list(b);if(a===null)return b}if(a===null)return c.extend(null,b);var f=[];for(var g=0;g<b.length;g++)f.push(a(b[g]));return f}a===null&&(a=Array);var h=null;for(g=1;g<arguments.length;g++){if(!e(arguments[g])){if(d)return d.list(d.imap.apply(null,arguments));throw new TypeError("Argument not an array-like and MochiKit.Iter not present")}var i=arguments[g].length;if(h===null||h>i)h=i}f=[];for(g=0;g<h;g++){var j=[];for(var k=1;k<arguments.length;k++)j.push(arguments[k][g]);f.push(a.apply(this,j))}return f},xfilter:function(a){var b=[];a===null&&(a=MochiKit.Base.operator.truth);for(var c=1;c<arguments.length;c++){var d=arguments[c];a(d)&&b.push(d)}return b},filter:function(a,b,c){var d=[],e=MochiKit.Base;if(!e.isArrayLike(b))if(MochiKit.Iter)b=MochiKit.Iter.list(b);else throw new TypeError("Argument not an array-like and MochiKit.Iter not present");a===null&&(a=e.operator.truth);if(typeof Array.prototype.filter=="function")return Array.prototype.filter.call(b,a,c);if(typeof c=="undefined"||c===null)for(var f=0;f<b.length;f++){var g=b[f];a(g)&&d.push(g)}else for(f=0;f<b.length;f++)g=b[f],a.call(c,g)&&d.push(g);return d},_wrapDumbFunction:function(_9f){return function(){switch(arguments.length){case 0:return _9f();case 1:return _9f(arguments[0]);case 2:return _9f(arguments[0],arguments[1]);case 3:return _9f(arguments[0],arguments[1],arguments[2])}var _a0=[];for(var i=0;i<arguments.length;i++)_a0.push("arguments["+i+"]");return eval("(func("+_a0.join(",")+"))")}},methodcaller:function(a){var b=MochiKit.Base.extend(null,arguments,1);return typeof a=="function"?function(c){return a.apply(c,b)}:function(c){return c[a].apply(c,b)}},method:function(a,b){var c=MochiKit.Base;return c.bind.apply(this,c.extend([b,a],arguments,2))},compose:function(a,b){var c=[],d=MochiKit.Base;if(arguments.length===0)throw new TypeError("compose() requires at least one argument");for(var e=0;e<arguments.length;e++){var f=arguments[e];if(typeof f!="function")throw new TypeError(d.repr(f)+" is not a function");c.push(f)}return function(){var a=arguments;for(var b=c.length-1;b>=0;b--)a=[c[b].apply(this,a)];return a[0]}},bind:function(a,b){typeof a=="string"&&(a=b[a]);var c=a.im_func,d=a.im_preargs,e=a.im_self,f=MochiKit.Base;typeof a=="function"&&typeof a.apply=="undefined"&&(a=f._wrapDumbFunction(a)),typeof c!="function"&&(c=a),typeof b!="undefined"&&(e=b),typeof d=="undefined"?d=[]:d=d.slice(),f.extend(d,arguments,2);var g=function(){var a=arguments,b=arguments.callee;b.im_preargs.length>0&&(a=f.concat(b.im_preargs,a));var c=b.im_self;return c||(c=this),b.im_func.apply(c,a)};return g.im_self=e,g.im_func=c,g.im_preargs=d,g},bindMethods:function(a){var b=MochiKit.Base.bind;for(var c in a){var d=a[c];typeof d=="function"&&(a[c]=b(d,a))}},registerComparator:function(a,b,c,d){MochiKit.Base.comparatorRegistry.register(a,b,c,d)},_primitives:{"boolean":!0,string:!0,number:!0},compare:function(a,b){if(a==b)return 0;var c=typeof a=="undefined"||a===null,d=typeof b=="undefined"||b===null;if(c&&d)return 0;if(c)return-1;if(d)return 1;var e=MochiKit.Base,f=e._primitives;if(!(typeof a in f&&typeof b in f))try{return e.comparatorRegistry.match(a,b)}catch(g){if(g!=e.NotFound)throw g}if(a<b)return-1;if(a>b)return 1;var h=e.repr;throw new TypeError(h(a)+" and "+h(b)+" can not be compared")},compareDateLike:function(a,b){return MochiKit.Base.compare(a.getTime(),b.getTime())},compareArrayLike:function(a,b){var c=MochiKit.Base.compare,d=a.length,e=0;d>b.length?(e=1,d=b.length):d<b.length&&(e=-1);for(var f=0;f<d;f++){var g=c(a[f],b[f]);if(g)return g}return e},registerRepr:function(a,b,c,d){MochiKit.Base.reprRegistry.register(a,b,c,d)},repr:function(a){if(typeof a=="undefined")return"undefined";if(a===null)return"null";try{return typeof a.__repr__=="function"?a.__repr__():typeof a.repr=="function"&&a.repr!=arguments.callee?a.repr():MochiKit.Base.reprRegistry.match(a)}catch(b){if(typeof a.NAME=="string"&&(a.toString==Function.prototype.toString||a.toString==Object.prototype.toString))return a.NAME}try{var c=a+""}catch(b){return"["+typeof a+"]"}if(typeof a=="function"){a=c.replace(/^\s+/,"");var d=a.indexOf("{");d!=-1&&(a=a.substr(0,d)+"{...}")}return c},reprArrayLike:function(a){var b=MochiKit.Base;return"["+b.map(b.repr,a).join(", ")+"]"},reprString:function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},reprNumber:function(a){return a+""},registerJSON:function(a,b,c,d){MochiKit.Base.jsonRegistry.register(a,b,c,d)},evalJSON:function(){return eval("("+MochiKit.Base._filterJSON(arguments[0])+")")},_filterJSON:function(a){var b=a.match(/^\s*\/\*(.*)\*\/\s*$/);return b?b[1]:a},serializeJSON:function(a){var b=typeof a;if(b=="number"||b=="boolean")return a+"";if(a===null)return"null";var c=MochiKit.Base,d=c.reprString;if(b=="string")return d(a);var e=arguments.callee,f;if(typeof a.__json__=="function"){f=a.__json__();if(a!==f)return e(f)}if(typeof a.json=="function"){f=a.json();if(a!==f)return e(f)}if(b!="function"&&typeof a.length=="number"){var g=[];for(var h=0;h<a.length;h++){var i=e(a[h]);typeof i!="string"&&(i="undefined"),g.push(i)}return"["+g.join(", ")+"]"}try{f=c.jsonRegistry.match(a);if(a!==f)return e(f)}catch(j){if(j!=c.NotFound)throw j}if(b=="undefined")throw new TypeError("undefined can not be serialized as JSON");if(b=="function")return null;g=[];for(var k in a){var l;if(typeof k=="number")l='"'+k+'"';else if(typeof k=="string")l=d(k);else continue;i=e(a[k]);if(typeof i!="string")continue;g.push(l+":"+i)}return"{"+g.join(", ")+"}"},objEqual:function(a,b){return MochiKit.Base.compare(a,b)===0},arrayEqual:function(a,b){return a.length!=b.length?!1:MochiKit.Base.compare(a,b)===0},concat:function(){var a=[],b=MochiKit.Base.extend;for(var c=0;c<arguments.length;c++)b(a,arguments[c]);return a},keyComparator:function(a){var b=MochiKit.Base,c=b.compare;if(arguments.length==1)return function(b,d){return c(b[a],d[a])};var d=b.extend(null,arguments);return function(a,b){var e=0;for(var f=0;e===0&&f<d.length;f++){var g=d[f];e=c(a[g],b[g])}return e}},reverseKeyComparator:function(a){var b=MochiKit.Base.keyComparator.apply(this,arguments);return function(a,c){return b(c,a)}},partial:function(a){var b=MochiKit.Base;return b.bind.apply(this,b.extend([a,undefined],arguments,1))},listMinMax:function(a,b){if(b.length===0)return null;var c=b[0],d=MochiKit.Base.compare;for(var e=1;e<b.length;e++){var f=b[e];d(f,c)==a&&(c=f)}return c},objMax:function(){return MochiKit.Base.listMinMax(1,arguments)},objMin:function(){return MochiKit.Base.listMinMax(-1,arguments)},findIdentical:function(a,b,c,d){if(typeof d=="undefined"||d===null)d=a.length;if(typeof c=="undefined"||c===null)c=0;for(var e=c;e<d;e++)if(a[e]===b)return e;return-1},mean:function(){var a=0,b=MochiKit.Base,c=b.extend(null,arguments),d=c.length;while(c.length){var e=c.shift();if(e&&typeof e=="object"&&typeof e.length=="number"){d+=e.length-1;for(var f=e.length-1;f>=0;f--)a+=e[f]}else a+=e}if(d<=0)throw new TypeError("mean() requires at least one argument");return a/d},median:function(){var a=MochiKit.Base.flattenArguments(arguments);if(a.length===0)throw new TypeError("median() requires at least one argument");a.sort(compare);if(a.length%2==0){var b=a.length/2;return(a[b]+a[b-1])/2}return a[(a.length-1)/2]},findValue:function(a,b,c,d){if(typeof d=="undefined"||d===null)d=a.length;if(typeof c=="undefined"||c===null)c=0;var e=MochiKit.Base.compare;for(var f=c;f<d;f++)if(e(a[f],b)===0)return f;return-1},nodeWalk:function(a,b){var c=[a],d=MochiKit.Base.extend;while(c.length){var e=b(c.shift());e&&d(c,e)}},nameFunctions:function(a){var b=a.NAME;typeof b=="undefined"?b="":b=b+".";for(var c in a){var d=a[c];if(typeof d=="function"&&typeof d.NAME=="undefined")try{d.NAME=b+c}catch(e){}}},queryString:function(a,b){if(typeof MochiKit.DOM!="undefined"&&arguments.length==1&&(typeof a=="string"||typeof a.nodeType!="undefined"&&a.nodeType>0)){var c=MochiKit.DOM.formContents(a);a=c[0],b=c[1]}else if(arguments.length==1){if(typeof a.length=="number"&&a.length==2)return arguments.callee(a[0],a[1]);var d=a;a=[],b=[];for(var e in d){var f=d[e];if(typeof f=="function")continue;if(typeof f!="string"&&typeof f.length=="number")for(var g=0;g<f.length;g++)a.push(e),b.push(f[g]);else a.push(e),b.push(f)}}var h=[],i=Math.min(a.length,b.length),j=MochiKit.Base.urlEncode;for(var g=0;g<i;g++)f=b[g],typeof f!="undefined"&&f!==null&&h.push(j(a[g])+"="+j(f));return h.join("&")},parseQueryString:function(a,b){var c=a.charAt(0)=="?"?a.substring(1):a,d=c.replace(/\+/g,"%20").split(/(\&amp\;|\&\#38\;|\&#x26;|\&)/),e={},f;typeof decodeURIComponent!="undefined"?f=decodeURIComponent:f=unescape;if(b)for(var g=0;g<d.length;g++){var h=d[g].split("="),i=f(h.shift());if(!i)continue;var j=e[i];j instanceof Array||(j=[],e[i]=j),j.push(f(h.join("=")))}else for(g=0;g<d.length;g++){h=d[g].split("=");var i=h.shift();if(!i)continue;e[f(i)]=f(h.join("="))}return e}}),MochiKit.Base.AdapterRegistry=function(){this.pairs=[]},MochiKit.Base.AdapterRegistry.prototype={register:function(a,b,c,d){d?this.pairs.unshift([a,b,c]):this.pairs.push([a,b,c])},match:function(){for(var a=0;a<this.pairs.length;a++){var b=this.pairs[a];if(b[1].apply(this,arguments))return b[2].apply(this,arguments)}throw MochiKit.Base.NotFound},unregister:function(a){for(var b=0;b<this.pairs.length;b++){var c=this.pairs[b];if(c[0]==a)return this.pairs.splice(b,1),!0}return!1}},MochiKit.Base.EXPORT=["flattenArray","noop","camelize","counter","clone","extend","update","updatetree","setdefault","keys","values","items","NamedError","operator","forwardCall","itemgetter","typeMatcher","isCallable","isUndefined","isUndefinedOrNull","isNull","isEmpty","isNotEmpty","isArrayLike","isDateLike","xmap","map","xfilter","filter","methodcaller","compose","bind","bindMethods","NotFound","AdapterRegistry","registerComparator","compare","registerRepr","repr","objEqual","arrayEqual","concat","keyComparator","reverseKeyComparator","partial","merge","listMinMax","listMax","listMin","objMax","objMin","nodeWalk","zip","urlEncode","queryString","serializeJSON","registerJSON","evalJSON","parseQueryString","findValue","findIdentical","flattenArguments","method","average","mean","median"],MochiKit.Base.EXPORT_OK=["nameFunctions","comparatorRegistry","reprRegistry","jsonRegistry","compareDateLike","compareArrayLike","reprArrayLike","reprString","reprNumber"],MochiKit.Base._exportSymbols=function(a,b){if(!MochiKit.__export__)return;var c=b.EXPORT_TAGS[":all"];for(var d=0;d<c.length;d++)a[c[d]]=b[c[d]]},MochiKit.Base.__new__=function(){var a=this;a.noop=a.operator.identity,a.forward=a.forwardCall,a.find=a.findValue,typeof encodeURIComponent!="undefined"?a.urlEncode=function(a){return encodeURIComponent(a).replace(/\'/g,"%27")}:a.urlEncode=function(a){return escape(a).replace(/\+/g,"%2B").replace(/\"/g,"%22").rval.replace(/\'/g,"%27")},a.NamedError=function(a){this.message=a,this.name=a},a.NamedError.prototype=new Error,a.update(a.NamedError.prototype,{repr:function(){return this.message&&this.message!=this.name?this.name+"("+a.repr(this.message)+")":this.name+"()"},toString:a.forwardCall("repr")}),a.NotFound=new a.NamedError("MochiKit.Base.NotFound"),a.listMax=a.partial(a.listMinMax,1),a.listMin=a.partial(a.listMinMax,-1),a.isCallable=a.typeMatcher("function"),a.isUndefined=a.typeMatcher("undefined"),a.merge=a.partial(a.update,null),a.zip=a.partial(a.map,null),a.average=a.mean,a.comparatorRegistry=new a.AdapterRegistry,a.registerComparator("dateLike",a.isDateLike,a.compareDateLike),a.registerComparator("arrayLike",a.isArrayLike,a.compareArrayLike),a.reprRegistry=new a.AdapterRegistry,a.registerRepr("arrayLike",a.isArrayLike,a.reprArrayLike),a.registerRepr("string",a.typeMatcher("string"),a.reprString),a.registerRepr("numbers",a.typeMatcher("number","boolean"),a.reprNumber),a.jsonRegistry=new a.AdapterRegistry;var b=a.concat(a.EXPORT,a.EXPORT_OK);a.EXPORT_TAGS={":common":a.concat(a.EXPORT_OK),":all":b},a.nameFunctions(this)},MochiKit.Base.__new__(),MochiKit.__export__&&(compare=MochiKit.Base.compare,compose=MochiKit.Base.compose,serializeJSON=MochiKit.Base.serializeJSON),MochiKit.Base._exportSymbols(this,MochiKit.Base),typeof dojo!="undefined"&&(dojo.provide("MochiKit.DOM"),dojo.require("MochiKit.Base")),typeof JSAN!="undefined"&&JSAN.use("MochiKit.Base",[]);try{if(typeof MochiKit.Base=="undefined")throw""}catch(e){throw"MochiKit.DOM depends on MochiKit.Base!"}typeof MochiKit.DOM=="undefined"&&(MochiKit.DOM={}),MochiKit.DOM.NAME="MochiKit.DOM",MochiKit.DOM.VERSION="1.4",MochiKit.DOM.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.DOM.toString=function(){return this.__repr__()},MochiKit.DOM.EXPORT=["removeEmptyTextNodes","formContents","currentWindow","currentDocument","withWindow","withDocument","registerDOMConverter","coerceToDOM","createDOM","createDOMFunc","isChildNode","getNodeAttribute","removeNodeAttribute","setNodeAttribute","updateNodeAttributes","appendChildNodes","insertSiblingNodesAfter","insertSiblingNodesBefore","replaceChildNodes","removeElement","swapDOM","BUTTON","TT","PRE","H1","H2","H3","BR","CANVAS","HR","LABEL","TEXTAREA","FORM","STRONG","SELECT","OPTION","OPTGROUP","LEGEND","FIELDSET","P","UL","OL","LI","TD","TR","THEAD","TBODY","TFOOT","TABLE","TH","INPUT","SPAN","A","DIV","IMG","getElement","$","getElementsByTagAndClassName","addToCallStack","addLoadEvent","focusOnLoad","setElementClass","toggleElementClass","addElementClass","removeElementClass","swapElementClass","hasElementClass","escapeHTML","toHTML","emitHTML","scrapeText","isParent","getFirstParentByTagAndClassName","makeClipping","undoClipping","makePositioned","undoPositioned","getFirstElementByTagAndClassName"],MochiKit.DOM.EXPORT_OK=["domConverters"],MochiKit.DOM.DEPRECATED=[["computedStyle","MochiKit.Style.getStyle","1.4"],["elementDimensions","MochiKit.Style.getElementDimensions","1.4"],["elementPosition","MochiKit.Style.getElementPosition","1.4"],["hideElement","MochiKit.Style.hideElement","1.4"],["setElementDimensions","MochiKit.Style.setElementDimensions","1.4"],["setElementPosition","MochiKit.Style.setElementPosition","1.4"],["setDisplayForElement","MochiKit.Style.setDisplayForElement","1.4"],["setOpacity","MochiKit.Style.setOpacity","1.4"],["showElement","MochiKit.Style.showElement","1.4"],["Coordinates","MochiKit.Style.Coordinates","1.4"],["Dimensions","MochiKit.Style.Dimensions","1.4"]],MochiKit.DOM.getViewportDimensions=new Function('if (!MochiKit["Style"]) {    throw new Error("This function has been deprecated and depends on MochiKit.Style.");}return MochiKit.Style.getViewportDimensions.apply(this, arguments);'),MochiKit.Base.update(MochiKit.DOM,{currentWindow:function(){return MochiKit.DOM._window},currentDocument:function(){return MochiKit.DOM._document},withWindow:function(a,b){var c=MochiKit.DOM,d=c._document,e=c._window,f;try{c._window=a,c._document=a.document,f=b()}catch(g){throw c._window=e,c._document=d,g}return c._window=e,c._document=d,f},formContents:function(a){var b=[],c=[],d=MochiKit.Base,e=MochiKit.DOM;return typeof a=="undefined"||a===null?a=e._document.body:a=e.getElement(a),d.nodeWalk(a,function(a){var e=a.name;if(d.isNotEmpty(e)){var f=a.tagName.toUpperCase();if(f!=="INPUT"||a.type!="radio"&&a.type!="checkbox"||!!a.checked){if(f==="SELECT"){if(a.type=="select-one"){if(a.selectedIndex>=0){var g=a.options[a.selectedIndex],h=g.value;if(!h){var i=g.outerHTML;i&&!i.match(/^[^>]+\svalue\s*=/i)&&(h=g.text)}return b.push(e),c.push(h),null}return b.push(e),c.push(""),null}var j=a.options;if(!j.length)return b.push(e),c.push(""),null;for(var k=0;k<j.length;k++){var g=j[k];if(!g.selected)continue;var h=g.value;if(!h){var i=g.outerHTML;i&&!i.match(/^[^>]+\svalue\s*=/i)&&(h=g.text)}b.push(e),c.push(h)}return null}return f==="FORM"||f==="P"||f==="SPAN"||f==="DIV"?a.childNodes:(b.push(e),c.push(a.value||""),null)}return null}return a.childNodes}),[b,c]},withDocument:function(a,b){var c=MochiKit.DOM,d=c._document,e;try{c._document=a,e=b()}catch(f){throw c._document=d,f}return c._document=d,e},registerDOMConverter:function(a,b,c,d){MochiKit.DOM.domConverters.register(a,b,c,d)},coerceToDOM:function(a,b){var c=MochiKit.Base,d=MochiKit.Iter,e=MochiKit.DOM;if(d)var f=d.iter,g=d.repeat,h=c.map;var i=e.domConverters,j=arguments.callee,k=c.NotFound;for(;;){if(typeof a=="undefined"||a===null)return null;typeof a=="function"&&typeof a.length=="number"&&!(a instanceof Function)&&(a=d.list(a));if(typeof a.nodeType!="undefined"&&a.nodeType>0)return a;if(typeof a=="number"||typeof a=="boolean")a=a.toString();if(typeof a=="string")return e._document.createTextNode(a);if(typeof a.__dom__=="function"){a=a.__dom__(b);continue}if(typeof a.dom=="function"){a=a.dom(b);continue}if(typeof a=="function"){a=a.apply(b,[b]);continue}if(d){var l=null;try{l=f(a)}catch(m){}if(l)return h(j,l,g(b))}try{a=i.match(a,b);continue}catch(m){if(m!=k)throw m}return e._document.createTextNode(a.toString())}return undefined},isChildNode:function(a,b){var c=MochiKit.DOM;typeof a=="string"&&(a=c.getElement(a)),typeof b=="string"&&(b=c.getElement(b));if(a===b)return!0;while(a&&a.tagName.toUpperCase()!="BODY"){a=a.parentNode;if(a===b)return!0}return!1},setNodeAttribute:function(a,b,c){var d={};d[b]=c;try{return MochiKit.DOM.updateNodeAttributes(a,d)}catch(e){}return null},getNodeAttribute:function(a,b){var c=MochiKit.DOM,d=c.attributeArray.renames[b];a=c.getElement(a);try{return d?a[d]:a.getAttribute(b)}catch(e){}return null},removeNodeAttribute:function(a,b){var c=MochiKit.DOM,d=c.attributeArray.renames[b];a=c.getElement(a);try{return d?a[d]:a.removeAttribute(b)}catch(e){}return null},updateNodeAttributes:function(a,b){var c=a,d=MochiKit.DOM;typeof a=="string"&&(c=d.getElement(a));if(b){var e=MochiKit.Base.updatetree;if(d.attributeArray.compliant)for(var f in b){var g=b[f];typeof g=="object"&&typeof c[f]=="object"?f=="style"&&MochiKit.Style?MochiKit.Style.setStyle(c,g):e(c[f],g):f.substring(0,2)=="on"?(typeof g=="string"&&(g=new Function(g)),c[f]=g):c.setAttribute(f,g)}else{var h=d.attributeArray.renames;for(var f in b){g=b[f];var i=h[f];f=="style"&&typeof g=="string"?c.style.cssText=g:typeof i=="string"?c[i]=g:typeof c[f]=="object"&&typeof g=="object"?f=="style"&&MochiKit.Style?MochiKit.Style.setStyle(c,g):e(c[f],g):f.substring(0,2)=="on"?(typeof g=="string"&&(g=new Function(g)),c[f]=g):c.setAttribute(f,g)}}}return c},appendChildNodes:function(a){var b=a,c=MochiKit.DOM;typeof a=="string"&&(b=c.getElement(a));var d=[c.coerceToDOM(MochiKit.Base.extend(null,arguments,1),b)],e=MochiKit.Base.concat;while(d.length){var f=d.shift();typeof f!="undefined"&&f!==null&&(typeof f.nodeType=="number"?b.appendChild(f):d=e(f,d))}return b},insertSiblingNodesBefore:function(a){var b=a,c=MochiKit.DOM;typeof a=="string"&&(b=c.getElement(a));var d=[c.coerceToDOM(MochiKit.Base.extend(null,arguments,1),b)],e=b.parentNode,f=MochiKit.Base.concat;while(d.length){var g=d.shift();typeof g!="undefined"&&g!==null&&(typeof g.nodeType=="number"?e.insertBefore(g,b):d=f(g,d))}return e},insertSiblingNodesAfter:function(a){var b=a,c=MochiKit.DOM;typeof a=="string"&&(b=c.getElement(a));var d=[c.coerceToDOM(MochiKit.Base.extend(null,arguments,1),b)];return b.nextSibling?c.insertSiblingNodesBefore(b.nextSibling,d):c.appendChildNodes(b.parentNode,d)},replaceChildNodes:function(a){var b=a,c=MochiKit.DOM;typeof a=="string"&&(b=c.getElement(a),arguments[0]=b);var d;while(d=b.firstChild)b.removeChild(d);return arguments.length<2?b:c.appendChildNodes.apply(this,arguments)},createDOM:function(a,b){var c,d=MochiKit.DOM,e=MochiKit.Base;if(typeof b=="string"||typeof b=="number"){var f=e.extend([a,null],arguments,1);return arguments.callee.apply(this,f)}if(typeof a=="string"){var g=d._xhtml;if(b&&!d.attributeArray.compliant){var h="";"name"in b&&(h+=' name="'+d.escapeHTML(b.name)+'"'),a=="input"&&"type"in b&&(h+=' type="'+d.escapeHTML(b.type)+'"'),h&&(a="<"+a+h+">",g=!1)}var i=d._document;g&&i===document?c=i.createElementNS("http://www.w3.org/1999/xhtml",a):c=i.createElement(a)}else c=a;b&&d.updateNodeAttributes(c,b);if(arguments.length<=2)return c;var f=e.extend([c],arguments,2);return d.appendChildNodes.apply(this,f)},createDOMFunc:function(){var a=MochiKit.Base;return a.partial.apply(this,a.extend([MochiKit.DOM.createDOM],arguments))},removeElement:function(a){var b=MochiKit.DOM.getElement(a);return b.parentNode.removeChild(b),b},swapDOM:function(a,b){var c=MochiKit.DOM;a=c.getElement(a);var d=a.parentNode;return b?(b=c.getElement(b),d.replaceChild(b,a)):d.removeChild(a),b},getElement:function(a){var b=MochiKit.DOM;return arguments.length==1?typeof a=="string"?b._document.getElementById(a):a:MochiKit.Base.map(b.getElement,arguments)},getElementsByTagAndClassName:function(a,b,c){var d=MochiKit.DOM;if(typeof a=="undefined"||a===null)a="*";if(typeof c=="undefined"||c===null)c=d._document;c=d.getElement(c);var e=c.getElementsByTagName(a)||d._document.all;if(typeof b=="undefined"||b===null)return MochiKit.Base.extend(null,e);var f=[];for(var g=0;g<e.length;g++){var h=e[g],i=h.className;if(!i)continue;var j=i.split(" ");for(var k=0;k<j.length;k++)if(j[k]==b){f.push(h);break}}return f},_newCallStack:function(a,b){var c=function(){var c=arguments.callee.callStack;for(var d=0;d<c.length;d++)if(c[d].apply(this,arguments)===!1)break;if(b)try{this[a]=null}catch(e){}};return c.callStack=[],c},addToCallStack:function(a,b,c,d){var e=MochiKit.DOM,f=a[b],g=f;if(typeof f!="function"||typeof f.callStack!="object"||f.callStack===null)g=e._newCallStack(b,d),typeof f=="function"&&g.callStack.push(f),a[b]=g;g.callStack.push(c)},addLoadEvent:function(a){var b=MochiKit.DOM;b.addToCallStack(b._window,"onload",a,!0)},focusOnLoad:function(a){var b=MochiKit.DOM;b.addLoadEvent(function(){a=b.getElement(a),a&&a.focus()})},setElementClass:function(a,b){var c=MochiKit.DOM,d=c.getElement(a);c.attributeArray.compliant?d.setAttribute("class",b):d.setAttribute("className",b)},toggleElementClass:function(a){var b=MochiKit.DOM;for(var c=1;c<arguments.length;c++){var d=b.getElement(arguments[c]);b.addElementClass(d,a)||b.removeElementClass(d,a)}},addElementClass:function(a,b){var c=MochiKit.DOM,d=c.getElement(a),e=d.className;if(e==undefined||e.length===0)return c.setElementClass(d,b),!0;if(e==b)return!1;var f=e.split(" ");for(var g=0;g<f.length;g++)if(f[g]==b)return!1;return c.setElementClass(d,e+" "+b),!0},removeElementClass:function(a,b){var c=MochiKit.DOM,d=c.getElement(a),e=d.className;if(e==undefined||e.length===0)return!1;if(e==b)return c.setElementClass(d,""),!0;var f=e.split(" ");for(var g=0;g<f.length;g++)if(f[g]==b)return f.splice(g,1),c.setElementClass(d,f.join(" ")),!0;return!1},swapElementClass:function(a,b,c){var d=MochiKit.DOM.getElement(a),e=MochiKit.DOM.removeElementClass(d,b);return e&&MochiKit.DOM.addElementClass(d,c),e},hasElementClass:function(a,b){var c=MochiKit.DOM.getElement(a),d=c.className;if(!d)return!1;var e=d.split(" ");for(var f=1;f<arguments.length;f++){var g=!1;for(var h=0;h<e.length;h++)if(e[h]==arguments[f]){g=!0;break}if(!g)return!1}return!0},escapeHTML:function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toHTML:function(a){return MochiKit.DOM.emitHTML(a).join("")},emitHTML:function(a,b){if(typeof b=="undefined"||b===null)b=[];var c=[a],d=MochiKit.DOM,e=d.escapeHTML,f=d.attributeArray;while(c.length){a=c.pop();if(typeof a=="string")b.push(a);else if(a.nodeType==1){b.push("<"+a.tagName.toLowerCase());var g=[],h=f(a);for(var i=0;i<h.length;i++){var j=h[i];g.push([" ",j.name,'="',e(j.value),'"'])}g.sort();for(i=0;i<g.length;i++){var k=g[i];for(var l=0;l<k.length;l++)b.push(k[l])}if(a.hasChildNodes()){b.push(">"),c.push("</"+a.tagName.toLowerCase()+">");var m=a.childNodes;for(i=m.length-1;i>=0;i--)c.push(m[i])}else b.push("/>")}else a.nodeType==3&&b.push(e(a.nodeValue))}return b},scrapeText:function(a,b){var c=[];return function(a){var b=a.childNodes;if(b)for(var d=0;d<b.length;d++)arguments.callee.call(this,b[d]);var e=a.nodeValue;typeof e=="string"&&c.push(e)}(MochiKit.DOM.getElement(a)),b?c:c.join("")},removeEmptyTextNodes:function(a){a=MochiKit.DOM.getElement(a);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];c.nodeType==3&&!/\S/.test(c.nodeValue)&&c.parentNode.removeChild(c)}},makeClipping:function(a){a=MochiKit.DOM.getElement(a);var b=a.style.overflow;return(MochiKit.Style.getStyle(a,"overflow")||"visible")!="hidden"&&(a.style.overflow="hidden"),b},undoClipping:function(a,b){a=MochiKit.DOM.getElement(a);if(!b)return;a.style.overflow=b},makePositioned:function(a){a=MochiKit.DOM.getElement(a);var b=MochiKit.Style.getStyle(a,"position");if(b=="static"||!b)a.style.position="relative",/Opera/.test(navigator.userAgent)&&(a.style.top=0,a.style.left=0)},undoPositioned:function(a){a=MochiKit.DOM.getElement(a),a.style.position=="relative"&&(a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right="")},getFirstElementByTagAndClassName:function(a,b,c){var d=MochiKit.DOM;if(typeof a=="undefined"||a===null)a="*";if(typeof c=="undefined"||c===null)c=d._document;c=d.getElement(c);var e=c.getElementsByTagName(a)||d._document.all;if(typeof b=="undefined"||b===null)return e[0];for(var f=0;f<e.length;f++){var g=e[f],h=g.className.split(" ");for(var i=0;i<h.length;i++)if(h[i]==b)return g}},getFirstParentByTagAndClassName:function(a,b,c){var d=MochiKit.DOM;a=d.getElement(a),typeof b=="undefined"||b===null?b="*":b=b.toUpperCase();if(typeof c=="undefined"||c===null)c=null;var e="",f="";while(a&&a.tagName){a=a.parentNode;if(b=="*"&&c===null)return a;e=a.className.split(" "),f=a.tagName.toUpperCase();if(c===null&&b==f)return a;if(c!==null)for(var g=0;g<e.length;g++){if(b=="*"&&e[g]==c)return a;if(b==f&&e[g]==c)return a}}return a},isParent:function(a,b){return!a.parentNode||a==b?!1:a.parentNode==b?!0:MochiKit.DOM.isParent(a.parentNode,b)},__new__:function(a){var b=MochiKit.Base;if(typeof document!="undefined"){this._document=document;var c="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";this._xhtml=document.documentElement&&document.createElementNS&&document.documentElement.namespaceURI===c}else MochiKit.MockDOM&&(this._document=MochiKit.MockDOM.document);this._window=a,this.domConverters=new b.AdapterRegistry;var d=this._document.createElement("span"),e;if(d&&d.attributes&&d.attributes.length>0){var f=b.filter;e=function(a){return f(e.ignoreAttrFilter,a.attributes)},e.ignoreAttr={};var g=d.attributes,h=e.ignoreAttr;for(var i=0;i<g.length;i++){var j=g[i];h[j.name]=j.value}e.ignoreAttrFilter=function(a){return e.ignoreAttr[a.name]!=a.value},e.compliant=!1,e.renames={"class":"className",checked:"defaultChecked",usemap:"useMap","for":"htmlFor",readonly:"readOnly",colspan:"colSpan",bgcolor:"bgColor",cellspacing:"cellSpacing",cellpadding:"cellPadding"}}else e=function(a){return a.attributes},e.compliant=!0,e.renames={};this.attributeArray=e;var k=function(a,b){var c=b[1].split("."),d="",e={};d+="if (!MochiKit."+c[1]+') { throw new Error("',d+="This function has been deprecated and depends on MochiKit.",d+=c[1]+'.");}',d+="return MochiKit."+c[1]+"."+b[0],d+=".apply(this, arguments);",e[c[2]]=new Function(d),MochiKit.Base.update(MochiKit[a],e)};for(var i;i<MochiKit.DOM.DEPRECATED.length;i++)k("DOM",MochiKit.DOM.DEPRECATED[i]);var l=this.createDOMFunc;this.UL=l("ul"),this.OL=l("ol"),this.LI=l("li"),this.TD=l("td"),this.TR=l("tr"),this.TBODY=l("tbody"),this.THEAD=l("thead"),this.TFOOT=l("tfoot"),this.TABLE=l("table"),this.TH=l("th"),this.INPUT=l("input"),this.SPAN=l("span"),this.A=l("a"),this.DIV=l("div"),this.IMG=l("img"),this.BUTTON=l("button"),this.TT=l("tt"),this.PRE=l("pre"),this.H1=l("h1"),this.H2=l("h2"),this.H3=l("h3"),this.BR=l("br"),this.HR=l("hr"),this.LABEL=l("label"),this.TEXTAREA=l("textarea"),this.FORM=l("form"),this.P=l("p"),this.SELECT=l("select"),this.OPTION=l("option"),this.OPTGROUP=l("optgroup"),this.LEGEND=l("legend"),this.FIELDSET=l("fieldset"),this.STRONG=l("strong"),this.CANVAS=l("canvas"),this.$=this.getElement,this.EXPORT_TAGS={":common":this.EXPORT,":all":b.concat(this.EXPORT,this.EXPORT_OK)},b.nameFunctions(this)}}),MochiKit.DOM.__new__(typeof window=="undefined"?this:window),MochiKit.__export__&&(withWindow=MochiKit.DOM.withWindow,withDocument=MochiKit.DOM.withDocument),MochiKit.Base._exportSymbols(this,MochiKit.DOM),typeof dojo!="undefined"&&(dojo.provide("MochiKit.Style"),dojo.require("MochiKit.Base"),dojo.require("MochiKit.DOM")),typeof JSAN!="undefined"&&(JSAN.use("MochiKit.Base",[]),JSAN.use("MochiKit.DOM",[]));try{if(typeof MochiKit.Base=="undefined")throw""}catch(e){throw"MochiKit.Style depends on MochiKit.Base!"}try{if(typeof MochiKit.DOM=="undefined")throw""}catch(e){throw"MochiKit.Style depends on MochiKit.DOM!"}typeof MochiKit.Style=="undefined"&&(MochiKit.Style={}),MochiKit.Style.NAME="MochiKit.Style",MochiKit.Style.VERSION="1.4",MochiKit.Style.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Style.toString=function(){return this.__repr__()},MochiKit.Style.EXPORT_OK=[],MochiKit.Style.EXPORT=["setStyle","setOpacity","getStyle","getElementDimensions","elementDimensions","setElementDimensions","getElementPosition","elementPosition","setElementPosition","setDisplayForElement","hideElement","showElement","getViewportDimensions","getViewportPosition","Dimensions","Coordinates"],MochiKit.Style.Dimensions=function(a,b){this.w=a,this.h=b},MochiKit.Style.Dimensions.prototype.__repr__=function(){var a=MochiKit.Base.repr;return"{w: "+a(this.w)+", h: "+a(this.h)+"}"},MochiKit.Style.Dimensions.prototype.toString=function(){return this.__repr__()},MochiKit.Style.Coordinates=function(a,b){this.x=a,this.y=b},MochiKit.Style.Coordinates.prototype.__repr__=function(){var a=MochiKit.Base.repr;return"{x: "+a(this.x)+", y: "+a(this.y)+"}"},MochiKit.Style.Coordinates.prototype.toString=function(){return this.__repr__()},MochiKit.Base.update(MochiKit.Style,{getStyle:function(a,b){var c=MochiKit.DOM,d=c._document;a=c.getElement(a),b=MochiKit.Base.camelize(b);if(!a||a==d)return undefined;if(b=="opacity"&&a.filters){var e=(MochiKit.Style.getStyle(a,"filter")||"").match(/alpha\(opacity=(.*)\)/);return e&&e[1]?parseFloat(e[1])/100:1}var f=a.style?a.style[b]:null;if(!f)if(d.defaultView&&d.defaultView.getComputedStyle){var g=d.defaultView.getComputedStyle(a,null);b=b.replace(/([A-Z])/g,"-$1").toLowerCase(),f=g?g.getPropertyValue(b):null}else a.currentStyle&&(f=a.currentStyle[b]);return b=="opacity"&&(f=parseFloat(f)),/Opera/.test(navigator.userAgent)&&MochiKit.Base.find(["left","top","right","bottom"],b)!=-1&&MochiKit.Style.getStyle(a,"position")=="static"&&(f="auto"),f=="auto"?null:f},setStyle:function(a,b){a=MochiKit.DOM.getElement(a);for(var c in b)c=="opacity"?MochiKit.Style.setOpacity(a,b[c]):a.style[MochiKit.Base.camelize(c)]=b[c]},setOpacity:function(a,b){a=MochiKit.DOM.getElement(a);var c=MochiKit.Style;if(b==1){var d=/Gecko/.test(navigator.userAgent)&&!/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent);a.style.opacity=d?.999999:1,/MSIE/.test(navigator.userAgent)&&(a.style.filter=c.getStyle(a,"filter").replace(/alpha\([^\)]*\)/gi,""))}else b<1e-5&&(b=0),a.style.opacity=b,/MSIE/.test(navigator.userAgent)&&(a.style.filter=c.getStyle(a,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+b*100+")")},getElementPosition:function(a,b){var c=MochiKit.Style,d=MochiKit.DOM;a=d.getElement(a);if(!a||(!a.x||!a.y)&&(!a.parentNode===null||c.getStyle(a,"display")=="none"))return undefined;var e=new c.Coordinates(0,0),f=null,g=null,h=MochiKit.DOM._document,i=h.documentElement,j=h.body;if(!a.parentNode&&a.x&&a.y)e.x+=a.x||0,e.y+=a.y||0;else if(a.getBoundingClientRect)f=a.getBoundingClientRect(),e.x+=f.left+(i.scrollLeft||j.scrollLeft)-(i.clientLeft||0),e.y+=f.top+(i.scrollTop||j.scrollTop)-(i.clientTop||0);else if(a.offsetParent){e.x+=a.offsetLeft,e.y+=a.offsetTop,g=a.offsetParent;if(g!=a)while(g)e.x+=g.offsetLeft,e.y+=g.offsetTop,g=g.offsetParent;var k=navigator.userAgent.toLowerCase();if(typeof opera!="undefined"&&parseFloat(opera.version())<9||k.indexOf("AppleWebKit")!=-1&&c.getStyle(a,"position")=="absolute")e.x-=j.offsetLeft,e.y-=j.offsetTop}typeof b!="undefined"&&(b=arguments.callee(b),b&&(e.x-=b.x||0,e.y-=b.y||0)),a.parentNode?g=a.parentNode:g=null;while(g){var l=g.tagName.toUpperCase();if(l==="BODY"||l==="HTML")break;var m=c.getStyle(g,"display");m!="inline"&&m!="table-row"&&(e.x-=g.scrollLeft,e.y-=g.scrollTop),g.parentNode?g=g.parentNode:g=null}return e},setElementPosition:function(a,b,c){a=MochiKit.DOM.getElement(a),typeof c=="undefined"&&(c="px");var d={},e=MochiKit.Base.isUndefinedOrNull;e(b.x)||(d.left=b.x+c),e(b.y)||(d.top=b.y+c),MochiKit.DOM.updateNodeAttributes(a,{style:d})},getElementDimensions:function(a){var b=MochiKit.Style,c=MochiKit.DOM;if(typeof a.w=="number"||typeof a.h=="number")return new b.Dimensions(a.w||0,a.h||0);a=c.getElement(a);if(!a)return undefined;var d=b.getStyle(a,"display");if(d!="none"&&d!==""&&typeof d!="undefined")return new b.Dimensions(a.offsetWidth||0,a.offsetHeight||0);var e=a.style,f=e.visibility,g=e.position;e.visibility="hidden",e.position="absolute",e.display="";var h=a.offsetWidth,i=a.offsetHeight;return e.display="none",e.position=g,e.visibility=f,new b.Dimensions(h,i)},setElementDimensions:function(a,b,c){a=MochiKit.DOM.getElement(a),typeof c=="undefined"&&(c="px");var d={},e=MochiKit.Base.isUndefinedOrNull;e(b.w)||(d.width=b.w+c),e(b.h)||(d.height=b.h+c),MochiKit.DOM.updateNodeAttributes(a,{style:d})},setDisplayForElement:function(a,b){var c=MochiKit.Base.extend(null,arguments,1),d=MochiKit.DOM.getElement;for(var e=0;e<c.length;e++)b=d(c[e]),b&&(b.style.display=a)},getViewportDimensions:function(){var a=new MochiKit.Style.Dimensions,b=MochiKit.DOM._window,c=MochiKit.DOM._document.body;return b.innerWidth?(a.w=b.innerWidth,a.h=b.innerHeight):c.parentElement.clientWidth?(a.w=c.parentElement.clientWidth,a.h=c.parentElement.clientHeight):c&&c.clientWidth&&(a.w=c.clientWidth,a.h=c.clientHeight),a},getViewportPosition:function(){var a=new MochiKit.Style.Coordinates(0,0),b=MochiKit.DOM._document,c=b.documentElement,d=b.body;return c&&(c.scrollTop||c.scrollLeft)?(a.x=c.scrollLeft,a.y=c.scrollTop):d&&(a.x=d.scrollLeft,a.y=d.scrollTop),a},__new__:function(){var a=MochiKit.Base;this.elementPosition=this.getElementPosition,this.elementDimensions=this.getElementDimensions,this.hideElement=a.partial(this.setDisplayForElement,"none"),this.showElement=a.partial(this.setDisplayForElement,"block"),this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)},a.nameFunctions(this)}}),MochiKit.Style.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Style),typeof dojo!="undefined"&&(dojo.provide("MochiKit.Signal"),dojo.require("MochiKit.Base"),dojo.require("MochiKit.DOM"),dojo.require("MochiKit.Style")),typeof JSAN!="undefined"&&(JSAN.use("MochiKit.Base",[]),JSAN.use("MochiKit.DOM",[]),JSAN.use("MochiKit.Style",[]));try{if(typeof MochiKit.Base=="undefined")throw""}catch(e){throw"MochiKit.Signal depends on MochiKit.Base!"}try{if(typeof MochiKit.DOM=="undefined")throw""}catch(e){throw"MochiKit.Signal depends on MochiKit.DOM!"}try{if(typeof MochiKit.Style=="undefined")throw""}catch(e){throw"MochiKit.Signal depends on MochiKit.Style!"}typeof MochiKit.Signal=="undefined"&&(MochiKit.Signal={}),MochiKit.Signal.NAME="MochiKit.Signal",MochiKit.Signal.VERSION="1.4",MochiKit.Signal._observers=[],MochiKit.Signal.Event=function(a,b){this._event=b||window.event,this._src=a},MochiKit.Base.update(MochiKit.Signal.Event.prototype,{__repr__:function(){var a=MochiKit.Base.repr,b="{event(): "+a(this.event())+", src(): "+a(this.src())+", type(): "+a(this.type())+", target(): "+a(this.target());if(this.type()&&this.type().indexOf("key")===0||this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu")b+=", modifier(): {alt: "+a(this.modifier().alt)+", ctrl: "+a(this.modifier().ctrl)+", meta: "+a(this.modifier().meta)+", shift: "+a(this.modifier().shift)+", any: "+a(this.modifier().any)+"}";this.type()&&this.type().indexOf("key")===0&&(b+=", key(): {code: "+a(this.key().code)+", string: "+a(this.key().string)+"}"),this.type()&&(this.type().indexOf("mouse")===0||this.type().indexOf("click")!=-1||this.type()=="contextmenu")&&(b+=", mouse(): {page: "+a(this.mouse().page)+", client: "+a(this.mouse().client),this.type()!="mousemove"?b+=", button: {left: "+a(this.mouse().button.left)+", middle: "+a(this.mouse().button.middle)+", right: "+a(this.mouse().button.right)+"}}":b+="}");if(this.type()=="mouseover"||this.type()=="mouseout")b+=", relatedTarget(): "+a(this.relatedTarget());return b+="}",b},toString:function(){return this.__repr__()},src:function(){return this._src},event:function(){return this._event},type:function(){return this._event.type||undefined},target:function(){return this._event.target||this._event.srcElement},_relatedTarget:null,relatedTarget:function(){if(this._relatedTarget!==null)return this._relatedTarget;var a=null;return this.type()=="mouseover"?a=this._event.relatedTarget||this._event.fromElement:this.type()=="mouseout"&&(a=this._event.relatedTarget||this._event.toElement),a!==null?(this._relatedTarget=a,a):undefined},_modifier:null,modifier:function(){if(this._modifier!==null)return this._modifier;var a={};return a.alt=this._event.altKey,a.ctrl=this._event.ctrlKey,a.meta=this._event.metaKey||!1,a.shift=this._event.shiftKey,a.any=a.alt||a.ctrl||a.shift||a.meta,this._modifier=a,a},_key:null,key:function(){if(this._key!==null)return this._key;var a={};if(this.type()&&this.type().indexOf("key")===0){if(this.type()=="keydown"||this.type()=="keyup")return a.code=this._event.keyCode,a.string=MochiKit.Signal._specialKeys[a.code]||"KEY_UNKNOWN",this._key=a,a;if(this.type()=="keypress")return a.code=0,a.string="",typeof this._event.charCode!="undefined"&&this._event.charCode!==0&&!MochiKit.Signal._specialMacKeys[this._event.charCode]?(a.code=this._event.charCode,a.string=String.fromCharCode(a.code)):this._event.keyCode&&typeof this._event.charCode=="undefined"&&(a.code=this._event.keyCode,a.string=String.fromCharCode(a.code)),this._key=a,a}return undefined},_mouse:null,mouse:function(){if(this._mouse!==null)return this._mouse;var a={},b=this._event;if(!this.type()||this.type().indexOf("mouse")!==0&&this.type().indexOf("click")==-1&&this.type()!="contextmenu")return undefined;a.client=new MochiKit.Style.Coordinates(0,0);if(b.clientX||b.clientY)a.client.x=!b.clientX||b.clientX<0?0:b.clientX,a.client.y=!b.clientY||b.clientY<0?0:b.clientY;a.page=new MochiKit.Style.Coordinates(0,0);if(b.pageX||b.pageY)a.page.x=!b.pageX||b.pageX<0?0:b.pageX,a.page.y=!b.pageY||b.pageY<0?0:b.pageY;else{var c=MochiKit.DOM._document.documentElement,d=MochiKit.DOM._document.body;a.page.x=b.clientX+(c.scrollLeft||d.scrollLeft)-(c.clientLeft||0),a.page.y=b.clientY+(c.scrollTop||d.scrollTop)-(c.clientTop||0)}return this.type()!="mousemove"&&(a.button={},a.button.left=!1,a.button.right=!1,a.button.middle=!1,b.which?(a.button.left=b.which==1,a.button.middle=b.which==2,a.button.right=b.which==3):(a.button.left=!!(b.button&1),a.button.right=!!(b.button&2),a.button.middle=!!(b.button&4))),this._mouse=a,a},stop:function(){this.stopPropagation(),this.preventDefault()},stopPropagation:function(){this._event.stopPropagation?this._event.stopPropagation():this._event.cancelBubble=!0},preventDefault:function(){this._event.preventDefault?this._event.preventDefault():this._confirmUnload===null&&(this._event.returnValue=!1)},_confirmUnload:null,confirmUnload:function(a){this.type()=="beforeunload"&&(this._confirmUnload=a,this._event.returnValue=a)}}),MochiKit.Signal._specialMacKeys={3:"KEY_ENTER",63289:"KEY_NUM_PAD_CLEAR",63276:"KEY_PAGE_UP",63277:"KEY_PAGE_DOWN",63275:"KEY_END",63273:"KEY_HOME",63234:"KEY_ARROW_LEFT",63232:"KEY_ARROW_UP",63235:"KEY_ARROW_RIGHT",63233:"KEY_ARROW_DOWN",63302:"KEY_INSERT",63272:"KEY_DELETE"},function(){var a=MochiKit.Signal._specialMacKeys;for(i=63236;i<=63242;i++)a[i]="KEY_F"+(i-63236+1)}(),MochiKit.Signal._specialKeys={8:"KEY_BACKSPACE",9:"KEY_TAB",12:"KEY_NUM_PAD_CLEAR",13:"KEY_ENTER",16:"KEY_SHIFT",17:"KEY_CTRL",18:"KEY_ALT",19:"KEY_PAUSE",20:"KEY_CAPS_LOCK",27:"KEY_ESCAPE",32:"KEY_SPACEBAR",33:"KEY_PAGE_UP",34:"KEY_PAGE_DOWN",35:"KEY_END",36:"KEY_HOME",37:"KEY_ARROW_LEFT",38:"KEY_ARROW_UP",39:"KEY_ARROW_RIGHT",40:"KEY_ARROW_DOWN",44:"KEY_PRINT_SCREEN",45:"KEY_INSERT",46:"KEY_DELETE",59:"KEY_SEMICOLON",91:"KEY_WINDOWS_LEFT",92:"KEY_WINDOWS_RIGHT",93:"KEY_SELECT",106:"KEY_NUM_PAD_ASTERISK",107:"KEY_NUM_PAD_PLUS_SIGN",109:"KEY_NUM_PAD_HYPHEN-MINUS",110:"KEY_NUM_PAD_FULL_STOP",111:"KEY_NUM_PAD_SOLIDUS",144:"KEY_NUM_LOCK",145:"KEY_SCROLL_LOCK",186:"KEY_SEMICOLON",187:"KEY_EQUALS_SIGN",188:"KEY_COMMA",189:"KEY_HYPHEN-MINUS",190:"KEY_FULL_STOP",191:"KEY_SOLIDUS",192:"KEY_GRAVE_ACCENT",219:"KEY_LEFT_SQUARE_BRACKET",220:"KEY_REVERSE_SOLIDUS",221:"KEY_RIGHT_SQUARE_BRACKET",222:"KEY_APOSTROPHE"},function(){var a=MochiKit.Signal._specialKeys;for(var b=48;b<=57;b++)a[b]="KEY_"+(b-48);for(b=65;b<=90;b++)a[b]="KEY_"+String.fromCharCode(b);for(b=96;b<=105;b++)a[b]="KEY_NUM_PAD_"+(b-96);for(b=112;b<=123;b++)a[b]="KEY_F"+(b-112+1)}(),MochiKit.Signal.Ident=function(a){this.source=a.source,this.signal=a.signal,this.listener=a.listener,this.isDOM=a.isDOM,this.objOrFunc=a.objOrFunc,this.funcOrStr=a.funcOrStr,this.connected=a.connected},MochiKit.Signal.Ident.prototype={},MochiKit.Base.update(MochiKit.Signal,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},_unloadCache:function(){var a=MochiKit.Signal,b=a._observers;for(var c=0;c<b.length;c++)b[c].signal!=="onload"&&b[c].signal!=="onunload"&&a._disconnect(b[c])},_listener:function(a,b,c,d,e){var f=MochiKit.Signal,g=f.Event;return e?(d=d||a,typeof c=="string"?b==="onload"||b==="onunload"?function(e){d[c].apply(d,[new g(a,e)]);var f=new MochiKit.Signal.Ident({source:a,signal:b,objOrFunc:d,funcOrStr:c});MochiKit.Signal._disconnect(f)}:function(b){d[c].apply(d,[new g(a,b)])}:b==="onload"||b==="onunload"?function(e){c.apply(d,[new g(a,e)]),MochiKit.Signal.disconnect(a,b,c);var f=new MochiKit.Signal.Ident({source:a,signal:b,objOrFunc:c});MochiKit.Signal._disconnect(f)}:function(b){c.apply(d,[new g(a,b)])}):MochiKit.Base.bind(c,d)},_browserAlreadyHasMouseEnterAndLeave:function(){return/MSIE/.test(navigator.userAgent)},_mouseEnterListener:function(a,b,c,d){var e=MochiKit.Signal.Event;return function(f){var g=new e(a,f);try{g.relatedTarget().nodeName}catch(h){return}g.stop();if(MochiKit.DOM.isChildNode(g.relatedTarget(),a))return;return g.type=function(){return b},typeof c=="string"?d[c].apply(d,[g]):c.apply(d,[g])}},_getDestPair:function(a,b){var c=null,d=null;if(typeof b!="undefined"){c=a,d=b;if(typeof b=="string"){if(typeof a[b]!="function")throw new Error("'funcOrStr' must be a function on 'objOrFunc'")}else if(typeof b!="function")throw new Error("'funcOrStr' must be a function or string")}else{if(typeof a!="function")throw new Error("'objOrFunc' must be a function if 'funcOrStr' is not given");d=a}return[c,d]},connect:function(a,b,c,d){a=MochiKit.DOM.getElement(a);var e=MochiKit.Signal;if(typeof b!="string")throw new Error("'sig' must be a string");var f=e._getDestPair(c,d),g=f[0],h=f[1];if(typeof g=="undefined"||g===null)g=a;var i=!!a.addEventListener||!!a.attachEvent;if(i&&(b==="onmouseenter"||b==="onmouseleave")&&!e._browserAlreadyHasMouseEnterAndLeave()){var j=e._mouseEnterListener(a,b.substr(2),h,g);b==="onmouseenter"?b="onmouseover":b="onmouseout"}else var j=e._listener(a,b,h,g,i);a.addEventListener?a.addEventListener(b.substr(2),j,!1):a.attachEvent&&a.attachEvent(b,j);var k=new MochiKit.Signal.Ident({source:a,signal:b,listener:j,isDOM:i,objOrFunc:c,funcOrStr:d,connected:!0});e._observers.push(k);if(!i&&typeof a.__connect__=="function"){var l=MochiKit.Base.extend([k],arguments,1);a.__connect__.apply(a,l)}return k},_disconnect:function(a){if(!a.connected)return;a.connected=!1;if(!a.isDOM)return;var b=a.source,c=a.signal,d=a.listener;if(b.removeEventListener)b.removeEventListener(c.substr(2),d,!1);else if(b.detachEvent)b.detachEvent(c,d);else throw new Error("'src' must be a DOM element")},disconnect:function(a){var b=MochiKit.Signal,c=b._observers,d=MochiKit.Base;if(arguments.length>1){var e=MochiKit.DOM.getElement(arguments[0]),f=arguments[1],g=arguments[2],h=arguments[3];for(var i=c.length-1;i>=0;i--){var j=c[i];if(j.source===e&&j.signal===f&&j.objOrFunc===g&&j.funcOrStr===h)return b._disconnect(j),b._lock?b._dirty=!0:c.splice(i,1),!0}}else{var k=d.findIdentical(c,a);if(k>=0)return b._disconnect(a),b._lock?b._dirty=!0:c.splice(k,1),!0}return!1},disconnectAllTo:function(a,b){var c=MochiKit.Signal,d=c._observers,e=c._disconnect,f=c._lock,g=c._dirty;typeof b=="undefined"&&(b=null);for(var h=d.length-1;h>=0;h--){var i=d[h];i.objOrFunc===a&&(b===null||i.funcOrStr===b)&&(e(i),f?g=!0:d.splice(h,1))}c._dirty=g},disconnectAll:function(a,b){a=MochiKit.DOM.getElement(a);var c=MochiKit.Base,d=c.flattenArguments(c.extend(null,arguments,1)),e=MochiKit.Signal,f=e._disconnect,g=e._observers,h,i,j=e._lock,k=e._dirty;if(d.length===0)for(h=g.length-1;h>=0;h--)i=g[h],i.source===a&&(f(i),j?k=!0:g.splice(h,1));else{var l={};for(h=0;h<d.length;h++)l[d[h]]=!0;for(h=g.length-1;h>=0;h--)i=g[h],i.source===a&&i.signal in l&&(f(i),j?k=!0:g.splice(h,1))}e._dirty=k},signal:function(a,b){var c=MochiKit.Signal,d=c._observers;a=MochiKit.DOM.getElement(a);var e=MochiKit.Base.extend(null,arguments,2),f=[];c._lock=!0;for(var g=0;g<d.length;g++){var h=d[g];if(h.source===a&&h.signal===b&&h.connected)try{h.listener.apply(a,e)}catch(i){f.push(i)}}c._lock=!1;if(c._dirty){c._dirty=!1;for(var g=d.length-1;g>=0;g--)d[g].connected||d.splice(g,1)}if(f.length==1)throw f[0];if(f.length>1){var i=new Error("Multiple errors thrown in handling 'sig', see errors property");throw i.errors=f,i}}}),MochiKit.Signal.EXPORT_OK=[],MochiKit.Signal.EXPORT=["connect","disconnect","signal","disconnectAll","disconnectAllTo"],MochiKit.Signal.__new__=function(a){var b=MochiKit.Base;this._document=document,this._window=a,this._lock=!1,this._dirty=!1;try{this.connect(window,"onunload",this._unloadCache)}catch(c){}this.EXPORT_TAGS={":common":this.EXPORT,":all":b.concat(this.EXPORT,this.EXPORT_OK)},b.nameFunctions(this)},MochiKit.Signal.__new__(this),MochiKit.__export__&&(connect=MochiKit.Signal.connect,disconnect=MochiKit.Signal.disconnect,disconnectAll=MochiKit.Signal.disconnectAll,signal=MochiKit.Signal.signal),MochiKit.Base._exportSymbols(this,MochiKit.Signal),typeof dojo!="undefined"&&(dojo.provide("MochiKit.Iter"),dojo.require("MochiKit.Base")),typeof JSAN!="undefined"&&JSAN.use("MochiKit.Base",[]);try{if(typeof MochiKit.Base=="undefined")throw""}catch(e){throw"MochiKit.Iter depends on MochiKit.Base!"}typeof MochiKit.Iter=="undefined"&&(MochiKit.Iter={}),MochiKit.Iter.NAME="MochiKit.Iter",MochiKit.Iter.VERSION="1.4",MochiKit.Base.update(MochiKit.Iter,{__repr__:function(){return"["+this.NAME+" "+this.VERSION+"]"},toString:function(){return this.__repr__()},registerIteratorFactory:function(a,b,c,d){MochiKit.Iter.iteratorRegistry.register(a,b,c,d)},iter:function(a,b){var c=MochiKit.Iter;if(arguments.length==2)return c.takewhile(function(a){return a!=b},a);if(typeof a.next=="function")return a;if(typeof a.iter=="function")return a.iter();try{return c.iteratorRegistry.match(a)}catch(d){var e=MochiKit.Base;throw d==e.NotFound&&(d=new TypeError(typeof a+": "+e.repr(a)+" is not iterable")),d}},count:function(a){a||(a=0);var b=MochiKit.Base;return{repr:function(){return"count("+a+")"},toString:b.forwardCall("repr"),next:b.counter(a)}},cycle:function(a){var b=MochiKit.Iter,c=MochiKit.Base,d=[],e=b.iter(a);return{repr:function(){return"cycle(...)"},toString:c.forwardCall("repr"),next:function(){try{var a=e.next();return d.push(a),a}catch(c){if(c!=b.StopIteration)throw c;if(d.length===0)this.next=function(){throw b.StopIteration};else{var f=-1;this.next=function(){return f=(f+1)%d.length,d[f]}}return this.next()}}}},repeat:function(a,b){var c=MochiKit.Base;return typeof b=="undefined"?{repr:function(){return"repeat("+c.repr(a)+")"},toString:c.forwardCall("repr"),next:function(){return a}}:{repr:function(){return"repeat("+c.repr(a)+", "+b+")"},toString:c.forwardCall("repr"),next:function(){if(b<=0)throw MochiKit.Iter.StopIteration;return b-=1,a}}},next:function(a){return a.next()},izip:function(a,b){var c=MochiKit.Base,d=MochiKit.Iter,e=d.next,f=c.map(d.iter,arguments);return{repr:function(){return"izip(...)"},toString:c.forwardCall("repr"),next:function(){return c.map(e,f)}}},ifilter:function(a,b){var c=MochiKit.Base;return b=MochiKit.Iter.iter(b),a===null&&(a=c.operator.truth),{repr:function(){return"ifilter(...)"},toString:c.forwardCall("repr"),next:function(){for(;;){var c=b.next();if(a(c))return c}return undefined}}},ifilterfalse:function(a,b){var c=MochiKit.Base;return b=MochiKit.Iter.iter(b),a===null&&(a=c.operator.truth),{repr:function(){return"ifilterfalse(...)"},toString:c.forwardCall("repr"),next:function(){for(;;){var c=b.next();if(!a(c))return c}return undefined}}},islice:function(a){var b=MochiKit.Iter,c=MochiKit.Base;a=b.iter(a);var d=0,e=0,f=1,g=-1;return arguments.length==2?e=arguments[1]:arguments.length==3?(d=arguments[1],e=arguments[2]):(d=arguments[1],e=arguments[2],f=arguments[3]),{repr:function(){return"islice("+["...",d,e,f].join(", ")+")"},toString:c.forwardCall("repr"),next:function(){var c;while(g<d)c=a.next(),g++;if(d>=e)throw b.StopIteration;return d+=f,c}}},imap:function(a,b,c){var d=MochiKit.Base,e=MochiKit.Iter,f=d.map(e.iter,d.extend(null,arguments,1)),g=d.map,h=e.next;return{repr:function(){return"imap(...)"},toString:d.forwardCall("repr"),next:function(){return a.apply(this,g(h,f))}}},applymap:function(a,b,c){b=MochiKit.Iter.iter(b);var d=MochiKit.Base;return{repr:function(){return"applymap(...)"},toString:d.forwardCall("repr"),next:function(){return a.apply(c,b.next())}}},chain:function(a,b){var c=MochiKit.Iter,d=MochiKit.Base;if(arguments.length==1)return c.iter(arguments[0]);var e=d.map(c.iter,arguments);return{repr:function(){return"chain(...)"},toString:d.forwardCall("repr"),next:function(){while(e.length>1)try{return e[0].next()}catch(a){if(a!=c.StopIteration)throw a;e.shift()}if(e.length==1){var b=e.shift();return this.next=d.bind("next",b),this.next()}throw c.StopIteration}}},takewhile:function(a,b){var c=MochiKit.Iter;return b=c.iter(b),{repr:function(){return"takewhile(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var d=b.next();return a(d)||(this.next=function(){throw c.StopIteration},this.next()),d}}},dropwhile:function(a,b){b=MochiKit.Iter.iter(b);var c=MochiKit.Base,d=c.bind;return{repr:function(){return"dropwhile(...)"},toString:c.forwardCall("repr"),next:function(){for(;;){var c=b.next();if(!a(c))break}return this.next=d("next",b),c}}},_tee:function(a,b,c){b.pos[a]=-1;var d=MochiKit.Base,e=d.listMin;return{repr:function(){return"tee("+a+", ...)"},toString:d.forwardCall("repr"),next:function(){var d,f=b.pos[a];return f==b.max?(d=c.next(),b.deque.push(d),b.max+=1,b.pos[a]+=1):(d=b.deque[f-b.min],b.pos[a]+=1,f==b.min&&e(b.pos)!=b.min&&(b.min+=1,b.deque.shift())),d}}},tee:function(a,b){var c=[],d={pos:[],deque:[],max:-1,min:-1};if(arguments.length==1||typeof b=="undefined"||b===null)b=2;var e=MochiKit.Iter;a=e.iter(a);var f=e._tee;for(var g=0;g<b;g++)c.push(f(g,d,a));return c},list:function(a){var b;if(a instanceof Array)return a.slice();if(typeof a!="function"||a instanceof Function||typeof a.length!="number"){var d=MochiKit.Iter;a=d.iter(a);var b=[];try{for(;;)b.push(a.next())}catch(e){if(e!=d.StopIteration)throw e;return b}return undefined}b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b},reduce:function(a,b,c){var d=0,e=c,f=MochiKit.Iter;b=f.iter(b);if(arguments.length<3){try{e=b.next()}catch(g){throw g==f.StopIteration&&(g=new TypeError("reduce() of empty sequence with no initial value")),g}d++}try{for(;;)e=a(e,b.next())}catch(g){if(g!=f.StopIteration)throw g}return e},range:function(){var a=0,b=0,c=1;if(arguments.length==1)b=arguments[0];else if(arguments.length==2)a=arguments[0],b=arguments[1];else if(arguments.length==3)a=arguments[0],b=arguments[1],c=arguments[2];else throw new TypeError("range() takes 1, 2, or 3 arguments!");if(c===0)throw new TypeError("range() step must not be 0");return{next:function(){if(c>0&&a>=b||c<0&&a<=b)throw MochiKit.Iter.StopIteration;var d=a;return a+=c,d},repr:function(){return"range("+[a,b,c].join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")}},sum:function(a,b){if(typeof b=="undefined"||b===null)b=0;var c=b,d=MochiKit.Iter;a=d.iter(a);try{for(;;)c+=a.next()}catch(e){if(e!=d.StopIteration)throw e}return c},exhaust:function(a){var b=MochiKit.Iter;a=b.iter(a);try{for(;;)a.next()}catch(c){if(c!=b.StopIteration)throw c}},forEach:function(a,b,c){var d=MochiKit.Base;arguments.length>2&&(b=d.bind(b,c));if(d.isArrayLike(a))try{for(var e=0;e<a.length;e++)b(a[e])}catch(f){if(f!=MochiKit.Iter.StopIteration)throw f}else c=MochiKit.Iter,c.exhaust(c.imap(b,a))},every:function(a,b){var c=MochiKit.Iter;try{return c.ifilterfalse(b,a).next(),!1}catch(d){if(d!=c.StopIteration)throw d;return!0}},sorted:function(a,b){var c=MochiKit.Iter.list(a);return arguments.length==1&&(b=MochiKit.Base.compare),c.sort(b),c},reversed:function(a){var b=MochiKit.Iter.list(a);return b.reverse(),b},some:function(a,b){var c=MochiKit.Iter;try{return c.ifilter(b,a).next(),!0}catch(d){if(d!=c.StopIteration)throw d;return!1}},iextend:function(a,b){if(MochiKit.Base.isArrayLike(b))for(var c=0;c<b.length;c++)a.push(b[c]);else{var d=MochiKit.Iter;b=d.iter(b);try{for(;;)a.push(b.next())}catch(e){if(e!=d.StopIteration)throw e}}return a},groupby:function(a,b){function h(){g=a.next(),f=b(g)}function i(){var a=g;return g=undefined,a}var c=MochiKit.Base,d=MochiKit.Iter;arguments.length<2&&(b=c.operator.identity),a=d.iter(a);var e=undefined,f=undefined,g,j=!0,k=c.compare;return{repr:function(){return"groupby(...)"},next:function(){while(k(f,e)===0){h();if(j){j=!1;break}}return e=f,[f,{next:function(){g==undefined&&h();if(k(f,e)!==0)throw d.StopIteration;return i()}}]}}},groupby_as_array:function(a,b){var c=MochiKit.Base,d=MochiKit.Iter;arguments.length<2&&(b=c.operator.identity),a=d.iter(a);var e=[],f=!0,g,h=c.compare;for(;;){try{var i=a.next(),j=b(i)}catch(k){if(k==d.StopIteration)break;throw k}if(f||h(j,g)!==0){var l=[];e.push([j,l])}l.push(i),f=!1,g=j}return e},arrayLikeIter:function(a){var b=0;return{repr:function(){return"arrayLikeIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(b>=a.length)throw MochiKit.Iter.StopIteration;return a[b++]}}},hasIterateNext:function(a){return a&&typeof a.iterateNext=="function"},iterateNextIter:function(a){return{repr:function(){return"iterateNextIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var b=a.iterateNext();if(b===null||b===undefined)throw MochiKit.Iter.StopIteration;return b}}}}),MochiKit.Iter.EXPORT_OK=["iteratorRegistry","arrayLikeIter","hasIterateNext","iterateNextIter"],MochiKit.Iter.EXPORT=["StopIteration","registerIteratorFactory","iter","count","cycle","repeat","next","izip","ifilter","ifilterfalse","islice","imap","applymap","chain","takewhile","dropwhile","tee","list","reduce","range","sum","exhaust","forEach","every","sorted","reversed","some","iextend","groupby","groupby_as_array"],MochiKit.Iter.__new__=function(){var a=MochiKit.Base;typeof StopIteration!="undefined"?this.StopIteration=StopIteration:this.StopIteration=new a.NamedError("StopIteration"),this.iteratorRegistry=new a.AdapterRegistry,this.registerIteratorFactory("arrayLike",a.isArrayLike,this.arrayLikeIter),this.registerIteratorFactory("iterateNext",this.hasIterateNext,this.iterateNextIter),this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)},a.nameFunctions(this)},MochiKit.Iter.__new__(),MochiKit.__export__&&(reduce=MochiKit.Iter.reduce),MochiKit.Base._exportSymbols(this,MochiKit.Iter),typeof dojo!="undefined"&&(dojo.provide("MochiKit.Async"),dojo.require("MochiKit.Base")),typeof JSAN!="undefined"&&JSAN.use("MochiKit.Base",[]);try{if(typeof MochiKit.Base=="undefined")throw""}catch(e){throw"MochiKit.Async depends on MochiKit.Base!"}typeof MochiKit.Async=="undefined"&&(MochiKit.Async={}),MochiKit.Async.NAME="MochiKit.Async",MochiKit.Async.VERSION="1.4",MochiKit.Async.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"},MochiKit.Async.toString=function(){return this.__repr__()},MochiKit.Async.Deferred=function(a){this.chain=[],this.id=this._nextId(),this.fired=-1,this.paused=0,this.results=[null,null],this.canceller=a,this.silentlyCancelled=!1,this.chained=!1},MochiKit.Async.Deferred.prototype={repr:function(){var a;return this.fired==-1?a="unfired":this.fired===0?a="success":a="error","Deferred("+this.id+", "+a+")"},toString:MochiKit.Base.forwardCall("repr"),_nextId:MochiKit.Base.counter(),cancel:function(){var a=MochiKit.Async;this.fired==-1?(this.canceller?this.canceller(this):this.silentlyCancelled=!0,this.fired==-1&&this.errback(new a.CancelledError(this))):this.fired===0&&this.results[0]instanceof a.Deferred&&this.results[0].cancel()},_resback:function(a){this.fired=a instanceof Error?1:0,this.results[this.fired]=a,this._fire()},_check:function(){if(this.fired!=-1){if(!this.silentlyCancelled)throw new MochiKit.Async.AlreadyCalledError(this);this.silentlyCancelled=!1;return}},callback:function(a){this._check();if(a instanceof MochiKit.Async.Deferred)throw new Error("Deferred instances can only be chained if they are the result of a callback");this._resback(a)},errback:function(a){this._check();var b=MochiKit.Async;if(a instanceof b.Deferred)throw new Error("Deferred instances can only be chained if they are the result of a callback");a instanceof Error||(a=new b.GenericError(a)),this._resback(a)},addBoth:function(a){return arguments.length>1&&(a=MochiKit.Base.partial.apply(null,arguments)),this.addCallbacks(a,a)},addCallback:function(a){return arguments.length>1&&(a=MochiKit.Base.partial.apply(null,arguments)),this.addCallbacks(a,null)},addErrback:function(a){return arguments.length>1&&(a=MochiKit.Base.partial.apply(null,arguments)),this.addCallbacks(null,a)},addCallbacks:function(a,b){if(this.chained)throw new Error("Chained Deferreds can not be re-used");return this.chain.push([a,b]),this.fired>=0&&this._fire(),this},_fire:function(){var a=this.chain,b=this.fired,c=this.results[b],d=this,e=null;while(a.length>0&&this.paused===0){var f=a.shift(),g=f[b];if(g===null)continue;try{c=g(c),b=c instanceof Error?1:0,c instanceof MochiKit.Async.Deferred&&(e=function(a){d._resback(a),d.paused--,d.paused===0&&d.fired>=0&&d._fire()},this.paused++)}catch(h){b=1,h instanceof Error||(h=new MochiKit.Async.GenericError(h)),c=h}}this.fired=b,this.results[b]=c,e&&this.paused&&(c.addBoth(e),c.chained=!0)}},MochiKit.Base.update(MochiKit.Async,{evalJSONRequest:function(a){return MochiKit.Base.evalJSON(a.responseText)},succeed:function(a){var b=new MochiKit.Async.Deferred;return b.callback.apply(b,arguments),b},fail:function(a){var b=new MochiKit.Async.Deferred;return b.errback.apply(b,arguments),b},getXMLHttpRequest:function(){var a=arguments.callee;if(!a.XMLHttpRequest){var b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},function(){throw new MochiKit.Async.BrowserComplianceError("Browser does not support XMLHttpRequest")}];for(var c=0;c<b.length;c++){var d=b[c];try{return a.XMLHttpRequest=d,d()}catch(e){}}}return a.XMLHttpRequest()},_xhr_onreadystatechange:function(a){var b=MochiKit.Base;if(this.readyState==4){try{this.onreadystatechange=null}catch(c){try{this.onreadystatechange=b.noop}catch(c){}}var d=null;try{d=this.status,!d&&b.isNotEmpty(this.responseText)&&(d=304)}catch(c){}if(d==200||d==201||d==204||d==304||d==1223)a.callback(this);else{var e=new MochiKit.Async.XMLHttpRequestError(this,"Request failed");e.number?a.errback(e):a.errback(e)}}},_xhr_canceller:function(a){try{a.onreadystatechange=null}catch(b){try{a.onreadystatechange=MochiKit.Base.noop}catch(b){}}a.abort()},sendXMLHttpRequest:function(a,b){if(typeof b=="undefined"||b===null)b="";var c=MochiKit.Base,d=MochiKit.Async,e=new d.Deferred(c.partial(d._xhr_canceller,a));try{a.onreadystatechange=c.bind(d._xhr_onreadystatechange,a,e),a.send(b)}catch(f){try{a.onreadystatechange=null}catch(g){}e.errback(f)}return e},doXHR:function(a,b){var c=MochiKit.Async;return c.callLater(0,c._doXHR,a,b)},_doXHR:function(a,b){var c=MochiKit.Base;b=c.update({method:"GET",sendContent:""},b);var d=MochiKit.Async,e=d.getXMLHttpRequest();if(b.queryString){var f=c.queryString(b.queryString);f&&(a+="?"+f)}"username"in b?e.open(b.method,a,!0,b.username,b.password):e.open(b.method,a,!0),e.overrideMimeType&&b.mimeType&&e.overrideMimeType(b.mimeType);if(b.headers){var g=b.headers;c.isArrayLike(g)||(g=c.items(g));for(var h=0;h<g.length;h++){var i=g[h],j=i[0],k=i[1];e.setRequestHeader(j,k)}}return d.sendXMLHttpRequest(e,b.sendContent)},_buildURL:function(a){if(arguments.length>1){var b=MochiKit.Base,c=b.queryString.apply(null,b.extend(null,arguments,1));if(c)return a+"?"+c}return a},doSimpleXMLHttpRequest:function(a){var b=MochiKit.Async;return a=b._buildURL.apply(b,arguments),b.doXHR(a)},loadJSONDoc:function(a){var b=MochiKit.Async;a=b._buildURL.apply(b,arguments);var c=b.doXHR(a,{mimeType:"text/plain",headers:[["Accept","application/json"]]});return c=c.addCallback(b.evalJSONRequest),c},wait:function(a,b){var c=new MochiKit.Async.Deferred,d=MochiKit.Base;typeof b!="undefined"&&c.addCallback(function(){return b});var e=setTimeout(d.bind("callback",c),Math.floor(a*1e3));return c.canceller=function(){try{clearTimeout(e)}catch(a){}},c},callLater:function(a,b){var c=MochiKit.Base,d=c.partial.apply(c,c.extend(null,arguments,1));return MochiKit.Async.wait(a).addCallback(function(a){return d()})}}),MochiKit.Async.DeferredLock=function(){this.waiting=[],this.locked=!1,this.id=this._nextId()},MochiKit.Async.DeferredLock.prototype={__class__:MochiKit.Async.DeferredLock,acquire:function(){var a=new MochiKit.Async.Deferred;return this.locked?this.waiting.push(a):(this.locked=!0,a.callback(this)),a},release:function(){if(!this.locked)throw TypeError("Tried to release an unlocked DeferredLock");this.locked=!1,this.waiting.length>0&&(this.locked=!0,this.waiting.shift().callback(this))},_nextId:MochiKit.Base.counter(),repr:function(){var a;return this.locked?a="locked, "+this.waiting.length+" waiting":a="unlocked","DeferredLock("+this.id+", "+a+")"},toString:MochiKit.Base.forwardCall("repr")},MochiKit.Async.DeferredList=function(a,b,c,d,e){MochiKit.Async.Deferred.apply(this,[e]),this.list=a;var f=[];this.resultList=f,this.finishedCount=0,this.fireOnOneCallback=b,this.fireOnOneErrback=c,this.consumeErrors=d;var g=MochiKit.Base.bind(this._cbDeferred,this);for(var h=0;h<a.length;h++){var i=a[h];f.push(undefined),i.addCallback(g,h,!0),i.addErrback(g,h,!1)}a.length===0&&!b&&this.callback(this.resultList)},MochiKit.Async.DeferredList.prototype=new MochiKit.Async.Deferred,MochiKit.Async.DeferredList.prototype._cbDeferred=function(a,b,c){return this.resultList[a]=[b,c],this.finishedCount+=1,this.fired==-1&&(b&&this.fireOnOneCallback?this.callback([a,c]):!b&&this.fireOnOneErrback?this.errback(c):this.finishedCount==this.list.length&&this.callback(this.resultList)),!b&&this.consumeErrors&&(c=null),c},MochiKit.Async.gatherResults=function(a){var b=new MochiKit.Async.DeferredList(a,!1,!0,!1);return b.addCallback(function(a){var b=[];for(var c=0;c<a.length;c++)b.push(a[c][1]);return b}),b},MochiKit.Async.maybeDeferred=function(a){var b=MochiKit.Async,c;try{var d=a.apply(null,MochiKit.Base.extend([],arguments,1));d instanceof b.Deferred?c=d:d instanceof Error?c=b.fail(d):c=b.succeed(d)}catch(e){c=b.fail(e)}return c},MochiKit.Async.EXPORT=["AlreadyCalledError","CancelledError","BrowserComplianceError","GenericError","XMLHttpRequestError","Deferred","succeed","fail","getXMLHttpRequest","doSimpleXMLHttpRequest","loadJSONDoc","wait","callLater","sendXMLHttpRequest","DeferredLock","DeferredList","gatherResults","maybeDeferred","doXHR"],MochiKit.Async.EXPORT_OK=["evalJSONRequest"],MochiKit.Async.__new__=function(){var a=MochiKit.Base,b=a.partial(a._newNamedError,this);b("AlreadyCalledError",function(a){this.deferred=a}),b("CancelledError",function(a){this.deferred=a}),b("BrowserComplianceError",function(a){this.message=a}),b("GenericError",function(a){this.message=a}),b("XMLHttpRequestError",function(a,b){this.req=a,this.message=b;try{this.number=a.status}catch(c){}}),this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)},a.nameFunctions(this)},MochiKit.Async.__new__(),MochiKit.Base._exportSymbols(this,MochiKit.Async)